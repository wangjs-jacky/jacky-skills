---
name: video-to-text
description: ä»è§†é¢‘å¹³å°æå–æ–‡æ¡ˆçš„ CLI å·¥å…·ã€‚å½“ç”¨æˆ·éœ€è¦ä»è§†é¢‘é“¾æ¥æå–æ–‡å­—å†…å®¹ã€ç”Ÿæˆå­—å¹•ã€è½¬å½•è¯­éŸ³æ—¶è§¦å‘ã€‚æ”¯æŒæŠ–éŸ³ç­‰å¹³å°ï¼ˆæŒç»­æ‰©å±•ä¸­ï¼‰ã€‚
---

# Video2Text - è§†é¢‘æ–‡æ¡ˆæå–å·¥å…·

ä»è§†é¢‘å¹³å°è‡ªåŠ¨æå–æ–‡å­—å†…å®¹çš„ä¸“ä¸š CLI å·¥å…·ã€‚

## è§¦å‘åœºæ™¯

- ç”¨æˆ·æƒ³ä»è§†é¢‘é“¾æ¥æå–æ–‡å­—/æ–‡æ¡ˆ
- éœ€è¦ä¸ºè§†é¢‘ç”Ÿæˆå­—å¹•æ–‡ä»¶ï¼ˆSRT/VTTï¼‰
- éœ€è¦è½¬å½•è§†é¢‘ä¸­çš„è¯­éŸ³å†…å®¹
- æ‰¹é‡å¤„ç†å¤šä¸ªè§†é¢‘é“¾æ¥

## æ”¯æŒå¹³å°

| å¹³å° | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| æŠ–éŸ³ | âœ… å·²æ”¯æŒ | å®Œæ•´æ”¯æŒï¼Œè‡ªåŠ¨å¤„ç†ç™»å½•è§†é¢‘ |
| Bç«™ | âœ… å·²æ”¯æŒ | å®Œæ•´æ”¯æŒï¼Œä½¿ç”¨ yt-dlp ä¸‹è½½ |
| æ›´å¤šå¹³å° | ğŸš§ å¼€å‘ä¸­ | æŒç»­æ‰©å±•ä¸­... |

## é¡¹ç›®ä¿¡æ¯

- **ä»“åº“**: `/Users/jiashengwang/jacky-github/jacky-video-to-text`
- **GitHub**: https://github.com/wangjs-jacky/video2text
- **npm**: `@wangjs-jacky/video2text`

## ä¾èµ–è¦æ±‚

æ‰§è¡Œå‰éœ€ç¡®è®¤ä»¥ä¸‹ä¾èµ–å·²å®‰è£…ï¼š

| ä¾èµ– | å®‰è£…æ–¹å¼ | å¿…éœ€ |
|------|----------|------|
| Node.js >= 18 | `brew install node` | æ˜¯ |
| yt-dlp | `brew install yt-dlp` | æ˜¯ |
| ffmpeg | `brew install ffmpeg` | æ˜¯ |
| f2 | `brew tap fyrfyrr/f2 && brew install f2` | å¦ï¼ˆæ¨èï¼‰ |

### Whisper æ¨¡å‹

é¦–æ¬¡ä½¿ç”¨éœ€ä¸‹è½½æ¨¡å‹ï¼š

```bash
cd /Users/jiashengwang/jacky-github/jacky-video-to-text
cd node_modules/whisper-node/lib/whisper.cpp/models
bash download-ggml-model.sh base
```

å¯é€‰æ¨¡å‹ï¼š`tiny`ã€`base`ã€`small`ã€`medium`ã€`large-v3`

## å®‰è£…æ–¹å¼

### å…¨å±€å®‰è£…ï¼ˆæ¨èï¼‰

```bash
# æœ¬åœ°å¼€å‘é“¾æ¥
cd /Users/jiashengwang/jacky-github/jacky-video-to-text
npm link

# æˆ–ä» npm å®‰è£…
npm install -g @wangjs-jacky/video2text
```

### ç›´æ¥è¿è¡Œ

```bash
cd /Users/jiashengwang/jacky-github/jacky-video-to-text
node bin/video2text.cjs <command> [options]
```

## å‘½ä»¤ä½¿ç”¨

### extract - æå–è§†é¢‘æ–‡æ¡ˆ

```bash
# åŸºç¡€ç”¨æ³•
video2text extract <è§†é¢‘URL>

# æŒ‡å®šæ ¼å¼å’Œè¾“å‡ºç›®å½•
video2text extract <URL> -f <txt|srt|vtt|md> -o <è¾“å‡ºç›®å½•>

# æŒ‡å®š Whisper æ¨¡å‹
video2text extract <URL> -m <tiny|base|small|medium|large-v3>

# æ‰¹é‡å¤„ç†
video2text extract --file <é“¾æ¥æ–‡ä»¶.txt>

# ä¿ç•™ä¸´æ—¶æ–‡ä»¶ï¼ˆè§†é¢‘å’ŒéŸ³é¢‘ï¼‰
video2text extract <URL> -k

# ä½¿ç”¨ Cookieï¼ˆéœ€ç™»å½•çš„è§†é¢‘ï¼‰
video2text extract <URL> -c "<cookieå†…å®¹>"
```

### serve - å¯åŠ¨ Web æœåŠ¡

```bash
# é»˜è®¤ç«¯å£ 3000
video2text serve

# æŒ‡å®šç«¯å£
video2text serve -p 8080
```

## å‘½ä»¤é€‰é¡¹

| é€‰é¡¹ | ç®€å†™ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `--format` | `-f` | txt | è¾“å‡ºæ ¼å¼ (txt/srt/vtt/md) |
| `--output` | `-o` | ./output | è¾“å‡ºç›®å½• |
| `--model` | `-m` | base | Whisper æ¨¡å‹ |
| `--keep` | `-k` | false | ä¿ç•™ä¸´æ—¶æ–‡ä»¶ |
| `--cookie` | `-c` | - | Cookieï¼ˆç”¨äºéœ€ç™»å½•çš„è§†é¢‘ï¼‰ |
| `--auto-cookie` | - | true | è‡ªåŠ¨ä»æµè§ˆå™¨è·å– Cookie |
| `--file` | - | - | æ‰¹é‡å¤„ç†çš„é“¾æ¥æ–‡ä»¶ |

## Web API

å¯åŠ¨æœåŠ¡åå¯é€šè¿‡ API è°ƒç”¨ï¼š

```bash
# å¯åŠ¨æœåŠ¡
video2text serve -p 3000

# API è°ƒç”¨
curl -X POST http://localhost:3000/api/extract \
  -H "Content-Type: application/json" \
  -d '{"url": "https://v.douyin.com/xxx/", "format": "txt"}'
```

## è¾“å‡ºæ ¼å¼

### TXTï¼ˆçº¯æ–‡æœ¬ï¼‰

```
[00:00] è¿™æ˜¯ç¬¬ä¸€å¥è¯
[00:03] è¿™æ˜¯ç¬¬äºŒå¥è¯
```

### SRTï¼ˆå­—å¹•ï¼‰

```
1
00:00:00,000 --> 00:00:03,000
è¿™æ˜¯ç¬¬ä¸€å¥è¯

2
00:00:03,000 --> 00:00:06,000
è¿™æ˜¯ç¬¬äºŒå¥è¯
```

### VTTï¼ˆWebVTTï¼‰

```
WEBVTT

00:00.000 --> 00:03.000
è¿™æ˜¯ç¬¬ä¸€å¥è¯

00:03.000 --> 00:06.000
è¿™æ˜¯ç¬¬äºŒå¥è¯
```

### Markdown

```markdown
# è§†é¢‘æ–‡æ¡ˆ

## [00:00] è¿™æ˜¯ç¬¬ä¸€å¥è¯

## [00:03] è¿™æ˜¯ç¬¬äºŒå¥è¯
```

## è¾“å‡ºç›®å½•ç»“æ„

```
output/
â””â”€â”€ [è§†é¢‘ID]/
    â”œâ”€â”€ [æ ‡é¢˜].mp4      # è§†é¢‘æ–‡ä»¶ï¼ˆä½¿ç”¨ -k æ—¶ä¿ç•™ï¼‰
    â”œâ”€â”€ [æ ‡é¢˜].wav      # éŸ³é¢‘æ–‡ä»¶ï¼ˆä½¿ç”¨ -k æ—¶ä¿ç•™ï¼‰
    â””â”€â”€ [æ ‡é¢˜].txt      # æå–çš„æ–‡æ¡ˆ
```

## å¸¸è§é—®é¢˜å¤„ç†

### éœ€è¦ç™»å½•çš„è§†é¢‘

å¦‚æœè§†é¢‘éœ€è¦ç™»å½•æ‰èƒ½æŸ¥çœ‹ï¼Œå·¥å…·ä¼šè‡ªåŠ¨å°è¯•ä» Chrome æµè§ˆå™¨è·å– Cookieã€‚

æ‰‹åŠ¨è·å– Cookie çš„æ–¹æ³•ï¼š
1. æ‰“å¼€ Chrome å¼€å‘è€…å·¥å…· (F12)
2. è®¿é—®ç›®æ ‡å¹³å°å¹¶ç™»å½•
3. åœ¨ Network æ ‡ç­¾æ‰¾åˆ°ä»»æ„è¯·æ±‚
4. å¤åˆ¶ Cookie è¯·æ±‚å¤´å†…å®¹
5. ä½¿ç”¨ `-c` é€‰é¡¹ä¼ å…¥

### ä¸‹è½½å¤±è´¥

1. ç¡®è®¤ç½‘ç»œå¯è®¿é—®ç›®æ ‡å¹³å°
2. å°è¯•ä½¿ç”¨ Cookieï¼š`-c "cookie"`
3. æ£€æŸ¥ URL æ˜¯å¦æœ‰æ•ˆ

### è½¬å½•è´¨é‡å·®

1. ä½¿ç”¨æ›´å¤§çš„æ¨¡å‹ï¼š`-m medium` æˆ– `-m large-v3`
2. ç¡®è®¤éŸ³é¢‘æ¸…æ™°åº¦

## æ‰§è¡Œæµç¨‹

```
URL â†’ ä¸‹è½½è§†é¢‘ â†’ æå–éŸ³é¢‘ â†’ è¯­éŸ³è½¬å½• â†’ æ ¼å¼åŒ–è¾“å‡º â†’ ä¿å­˜æ–‡ä»¶
        â†“           â†“           â†“            â†“
     f2/yt-dlp    ffmpeg    whisper.cpp   formatter
```

## æ‰©å±•å¹³å°

å¦‚éœ€æ·»åŠ æ–°å¹³å°æ”¯æŒï¼Œéœ€è¦å®ç°ï¼š
1. URL è§£æå™¨ï¼ˆ`src/core/url-parser.ts`ï¼‰
2. ä¸‹è½½å™¨é€‚é…ï¼ˆ`src/core/downloader.ts`ï¼‰
3. å¹³å°ç‰¹å®šçš„ Cookie å¤„ç†ï¼ˆå¦‚éœ€è¦ï¼‰
